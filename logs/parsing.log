2025-11-27 13:00:26 [restartedMain] INFO  o.n.b.config.DataInitializer - 대용량 CSV 데이터 초기화 시작
2025-11-27 13:00:26 [restartedMain] INFO  o.n.b.config.DataInitializer - 캐시 워밍업 중 (기존 데이터 로드)...
2025-11-27 13:00:26 [restartedMain] INFO  o.n.b.config.DataInitializer - 캐시 로드 완료 (Publisher: 0, Contributor: 0)
2025-11-27 13:00:26 [restartedMain] INFO  o.n.b.config.DataInitializer - 파일 읽기 시작: BOOK_DB_202112.csv
2025-11-27 13:00:27 [restartedMain] INFO  o.n.b.config.DataInitializer - 총 157118건의 데이터 처리를 시작합니다.
2025-11-27 13:01:21 [restartedMain] INFO  o.n.b.config.DataInitializer - 대용량 CSV 데이터 초기화 시작
2025-11-27 13:01:21 [restartedMain] INFO  o.n.b.config.DataInitializer - 캐시 워밍업 중 (기존 데이터 로드)...
2025-11-27 13:01:21 [restartedMain] INFO  o.n.b.config.DataInitializer - 캐시 로드 완료 (Publisher: 0, Contributor: 0)
2025-11-27 13:01:21 [restartedMain] INFO  o.n.b.config.DataInitializer - 파일 읽기 시작: BOOK_DB_202112.csv
2025-11-27 13:01:22 [restartedMain] INFO  o.n.b.config.DataInitializer - 총 157118건의 데이터 처리를 시작합니다.
2025-11-27 13:02:46 [restartedMain] ERROR o.n.b.config.DataInitializer - 파일 처리 중 치명적 오류 발생: BOOK_DB_202112.csv
org.springframework.orm.jpa.JpaSystemException: Unable to rollback against JDBC Connection
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:348)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.convertHibernateAccessException(HibernateJpaDialect.java:256)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:241)
	at org.springframework.orm.jpa.JpaTransactionManager.doRollback(JpaTransactionManager.java:594)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processRollback(AbstractPlatformTransactionManager.java:897)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.rollback(AbstractPlatformTransactionManager.java:866)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.completeTransactionAfterThrowing(TransactionAspectSupport.java:716)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:384)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at org.nhnacademy.book2onandonbookservice.repository.BatchInsertRepository$$SpringCGLIB$$0.saveBookRelations(<generated>)
	at org.nhnacademy.book2onandonbookservice.config.DataInitializer.saveBatch(DataInitializer.java:196)
	at org.nhnacademy.book2onandonbookservice.config.DataInitializer.processCsvFile(DataInitializer.java:136)
	at org.nhnacademy.book2onandonbookservice.config.DataInitializer.run(DataInitializer.java:85)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at org.nhnacademy.book2onandonbookservice.config.DataInitializer$$SpringCGLIB$$0.run(<generated>)
	at org.springframework.boot.SpringApplication.lambda$callRunner$4(SpringApplication.java:784)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:796)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:784)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:772)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:772)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:325)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at org.nhnacademy.book2onandonbookservice.Book2OnAndOnBookServiceApplication.main(Book2OnAndOnBookServiceApplication.java:16)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:50)
Caused by: org.hibernate.TransactionException: Unable to rollback against JDBC Connection
	at org.hibernate.resource.jdbc.internal.AbstractLogicalConnectionImplementor.rollback(AbstractLogicalConnectionImplementor.java:137)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.rollback(JdbcResourceLocalTransactionCoordinatorImpl.java:289)
	at org.hibernate.engine.transaction.internal.TransactionImpl.rollback(TransactionImpl.java:142)
	at org.springframework.orm.jpa.JpaTransactionManager.doRollback(JpaTransactionManager.java:590)
	... 39 common frames omitted
Caused by: java.sql.SQLException: Connection is closed
	at com.zaxxer.hikari.pool.ProxyConnection$ClosedConnection.lambda$getClosedConnection$0(ProxyConnection.java:562)
	at jdk.proxy3/jdk.proxy3.$Proxy138.rollback(Unknown Source)
	at com.zaxxer.hikari.pool.ProxyConnection.rollback(ProxyConnection.java:386)
	at com.zaxxer.hikari.pool.HikariProxyConnection.rollback(HikariProxyConnection.java)
	at org.hibernate.resource.jdbc.internal.AbstractLogicalConnectionImplementor.rollback(AbstractLogicalConnectionImplementor.java:127)
	... 42 common frames omitted
2025-11-27 13:02:46 [restartedMain] INFO  o.n.b.config.DataInitializer - 전체 초기화 완료! 소요 시간: 84초
2025-11-27 13:03:16 [restartedMain] INFO  o.n.b.config.DataInitializer - 대용량 CSV 데이터 초기화 시작
2025-11-27 13:03:16 [restartedMain] INFO  o.n.b.config.DataInitializer - 캐시 워밍업 중 (기존 데이터 로드)...
2025-11-27 13:03:16 [restartedMain] INFO  o.n.b.config.DataInitializer - 캐시 로드 완료 (Publisher: 0, Contributor: 0)
2025-11-27 13:03:16 [restartedMain] INFO  o.n.b.config.DataInitializer - 파일 읽기 시작: BOOK_DB_202112.csv
2025-11-27 13:03:17 [restartedMain] INFO  o.n.b.config.DataInitializer - 총 157118건의 데이터 처리를 시작합니다.
2025-11-27 13:03:43 [restartedMain] INFO  o.n.b.config.DataInitializer - 대용량 CSV 데이터 초기화 시작
2025-11-27 13:03:43 [restartedMain] INFO  o.n.b.config.DataInitializer - 캐시 워밍업 중 (기존 데이터 로드)...
2025-11-27 13:03:43 [restartedMain] INFO  o.n.b.config.DataInitializer - 캐시 로드 완료 (Publisher: 0, Contributor: 0)
2025-11-27 13:03:43 [restartedMain] INFO  o.n.b.config.DataInitializer - 파일 읽기 시작: BOOK_DB_202112.csv
2025-11-27 13:03:44 [restartedMain] INFO  o.n.b.config.DataInitializer - 총 157118건의 데이터 처리를 시작합니다.
2025-11-27 13:03:53 [restartedMain] ERROR o.n.b.config.DataInitializer - 파일 처리 중 치명적 오류 발생: BOOK_DB_202112.csv
org.springframework.transaction.CannotCreateTransactionException: Could not open JPA EntityManager for transaction
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:467)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.startTransaction(AbstractPlatformTransactionManager.java:532)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.getTransaction(AbstractPlatformTransactionManager.java:405)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.createTransactionIfNecessary(TransactionAspectSupport.java:639)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:374)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:119)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at org.nhnacademy.book2onandonbookservice.repository.BatchInsertRepository$$SpringCGLIB$$0.saveAllBooks(<generated>)
	at org.nhnacademy.book2onandonbookservice.config.DataInitializer.saveBatch(DataInitializer.java:159)
	at org.nhnacademy.book2onandonbookservice.config.DataInitializer.processCsvFile(DataInitializer.java:136)
	at org.nhnacademy.book2onandonbookservice.config.DataInitializer.run(DataInitializer.java:85)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at org.nhnacademy.book2onandonbookservice.config.DataInitializer$$SpringCGLIB$$0.run(<generated>)
	at org.springframework.boot.SpringApplication.lambda$callRunner$4(SpringApplication.java:784)
	at org.springframework.util.function.ThrowingConsumer$1.acceptWithException(ThrowingConsumer.java:82)
	at org.springframework.util.function.ThrowingConsumer.accept(ThrowingConsumer.java:60)
	at org.springframework.util.function.ThrowingConsumer$1.accept(ThrowingConsumer.java:86)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:796)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:784)
	at org.springframework.boot.SpringApplication.lambda$callRunners$3(SpringApplication.java:772)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:184)
	at java.base/java.util.stream.SortedOps$SizedRefSortingSink.end(SortedOps.java:357)
	at java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:510)
	at java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)
	at java.base/java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:151)
	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:174)
	at java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
	at java.base/java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:596)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:772)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:325)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)
	at org.nhnacademy.book2onandonbookservice.Book2OnAndOnBookServiceApplication.main(Book2OnAndOnBookServiceApplication.java:16)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:50)
Caused by: java.lang.IllegalStateException: EntityManagerFactory is closed
	at org.hibernate.internal.SessionFactoryImpl.validateNotClosed(SessionFactoryImpl.java:701)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:759)
	at org.hibernate.internal.SessionFactoryImpl.createEntityManager(SessionFactoryImpl.java:167)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.createNativeEntityManager(AbstractEntityManagerFactoryBean.java:594)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.invokeProxyMethod(AbstractEntityManagerFactoryBean.java:497)
	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean$ManagedEntityManagerFactoryInvocationHandler.invoke(AbstractEntityManagerFactoryBean.java:750)
	at jdk.proxy6/jdk.proxy6.$Proxy248.createNativeEntityManager(Unknown Source)
	at org.springframework.orm.jpa.JpaTransactionManager.createEntityManagerForTransaction(JpaTransactionManager.java:485)
	at org.springframework.orm.jpa.JpaTransactionManager.doBegin(JpaTransactionManager.java:410)
	... 39 common frames omitted
2025-11-27 13:03:53 [restartedMain] INFO  o.n.b.config.DataInitializer - 전체 초기화 완료! 소요 시간: 37초
2025-11-27 13:04:16 [restartedMain] INFO  o.n.b.config.DataInitializer - 대용량 CSV 데이터 초기화 시작
2025-11-27 13:04:16 [restartedMain] INFO  o.n.b.config.DataInitializer - 캐시 워밍업 중 (기존 데이터 로드)...
2025-11-27 13:04:16 [restartedMain] INFO  o.n.b.config.DataInitializer - 캐시 로드 완료 (Publisher: 0, Contributor: 0)
2025-11-27 13:04:16 [restartedMain] INFO  o.n.b.config.DataInitializer - 파일 읽기 시작: BOOK_DB_202112.csv
2025-11-27 13:04:17 [restartedMain] INFO  o.n.b.config.DataInitializer - 총 157118건의 데이터 처리를 시작합니다.
2025-11-27 13:06:13 [restartedMain] INFO  o.n.b.config.DataInitializer - 대용량 CSV 데이터 초기화 시작
2025-11-27 13:06:13 [restartedMain] INFO  o.n.b.config.DataInitializer - 캐시 워밍업 중 (기존 데이터 로드)...
2025-11-27 13:06:13 [restartedMain] INFO  o.n.b.config.DataInitializer - 캐시 로드 완료 (Publisher: 0, Contributor: 0)
2025-11-27 13:06:13 [restartedMain] INFO  o.n.b.config.DataInitializer - 파일 읽기 시작: BOOK_DB_202112.csv
2025-11-27 13:06:14 [restartedMain] INFO  o.n.b.config.DataInitializer - 총 157118건의 데이터 처리를 시작합니다.
